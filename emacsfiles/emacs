(package-initialize)
(require 'package)

(require 'ido)
(ido-mode t)

; Org settings
; ============
(add-to-list 'load-path (expand-file-name "~/dotfiles/submodules/org-mode/lisp"))
(add-to-list 'load-path (expand-file-name "~/dotfiles/submodules/org-mode/contrib/lisp"))
(require 'org)
(require 'org-checklist)

; key settings
(global-set-key "\C-cl" 'org-store-link)
(global-set-key "\C-cc" 'org-capture)
(global-set-key "\C-ca" 'org-agenda)
(global-set-key "\C-cb" 'org-iswitchb)

; variables
(setq org-directory "~/org")
; gtd is not strictly following the GTD book, I am tweaking
(setq gtd-inbox (concat org-directory "/inbox.org"))
(setq gtd-next (concat org-directory "/next.org"))
(setq gtd-someday (concat org-directory "/someday.org"))
(setq gtd-projects (concat org-directory "/projects.org"))
(setq gtd-routines (concat org-directory "/routines.org"))

; org settings
(setq org-catch-invisible-edits t)
(setq org-startup-indented t)
(setq org-log-into-drawer "LOGBOOK")
(setq org-clock-into-drawer t)

(setq org-agenda-files
      (list gtd-inbox gtd-next gtd-someday gtd-projects gtd-routines))

; Targets include this file and any file contributing to the agenda - up to 9 levels deep
(setq org-refile-targets (quote ((nil :maxlevel . 9)
                                 (org-agenda-files :maxlevel . 9))))

; org-capture
(setq org-default-notes-file gtd-inbox)
(setq org-capture-templates
      '(("c" "Capture" entry (file gtd-inbox)
         "* TODO %?\n  %U\n  %a")
        ("j" "Journal" entry (file+datetree "~/org/journal.org")
         (file "~/org/templates/journal.txt"))))

; todo keywords (http://doc.norang.ca/org-mode.html)
(setq org-use-fast-todo-selection t)
(setq org-treat-S-cursor-todo-selection-as-state-change nil)

(setq org-todo-keywords
      (quote ((sequence "TODO(t)" "NEXT(n)" "|" "DONE(d)")
              (sequence "WAITING(w@/!)" "HOLD(h@/!)" "|" "CANCELLED(c@/!)" "PHONE" "MEETING"))))

(setq org-todo-keyword-faces
      (quote (("TODO" :foreground "red" :weight bold)
              ("NEXT" :foreground "red" :weight bold)
              ("DONE" :foreground "forest green" :weight bold)
              ("WAITING" :foreground "orange" :weight bold)
              ("HOLD" :foreground "magenta" :weight bold)
              ("CANCELLED" :foreground "forest green" :weight bold)
              ("MEETING" :foreground "forest green" :weight bold)
              ("PHONE" :foreground "forest green" :weight bold))))

; Writing
; ============
; reftex (http://nakkaya.com/2010/09/07/writing-papers-using-org-mode/)
(setq reftex-default-bibliography
      (quote ("~/reftex.bib")))

(defun na-org-mode-reftex-setup ()
  (interactive)
  (load-library "reftex")
  (and (buffer-file-name)
       (file-exists-p (buffer-file-name))
       (reftex-parse-all)))

(add-hook 'org-mode-hook 'na-org-mode-reftex-setup)

; vim: set filetype=lisp:
