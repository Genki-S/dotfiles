#!/bin/sh

pullrequest_template_file="$HOME/.plrq_template"
plrq_editmsg="`git rev-parse --show-toplevel`/.git/PULLREQ_EDITMSG"

cat $pullrequest_template_file >> $plrq_editmsg
vim -c 'set ft=gitcommit tw=0 wrap lbr' $*

# Backup
cp $plrq_editmsg ${plrq_editmsg}.bk

# Check if there are no check miss
grep '^#\[ \]' $plrq_editmsg &> /dev/null
if [[ $? -eq 0 ]]; then
  echo "Insufficient check with pull request message." >&2
  exit 1
else
  exit 0
fi
